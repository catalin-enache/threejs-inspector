import{r as o,j as r,v as de,e as he,T as pe,w as fe,x as me,y as ge,g as be,h as we,z as xe,E as ye,B as ve,G as je,I as Se,J as Y,M as O,N as Ce,Q as Me,R as Re,V as D,o as A,U as H,X as J,Y as Le,Z as V,_ as F,$ as _e,a0 as Ee,a1 as re,q as ke,a2 as Ie,b as Be,a3 as ze,a4 as Pe,u as Ge,a as U,n as k,a5 as Te,a6 as De,a7 as He,a8 as Z,a9 as $,aa as Ae,f as G}from"./main-BIwCVeWb.js";function Q(e,n){let d;return(...h)=>{window.clearTimeout(d),d=window.setTimeout(()=>e(...h),n)}}function Oe({debounce:e,scroll:n,polyfill:d,offsetSize:h}={debounce:0,scroll:!1,offsetSize:!1}){const g=d||(typeof window>"u"?class{}:window.ResizeObserver);if(!g)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[c,b]=o.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),t=o.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:c,orientationHandler:null}),a=e?typeof e=="number"?e:e.scroll:null,j=e?typeof e=="number"?e:e.resize:null,u=o.useRef(!1);o.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[w,m,l]=o.useMemo(()=>{const i=()=>{if(!t.current.element)return;const{left:_,top:s,width:f,height:R,bottom:L,right:x,x:C,y:E}=t.current.element.getBoundingClientRect(),y={left:_,top:s,width:f,height:R,bottom:L,right:x,x:C,y:E};t.current.element instanceof HTMLElement&&h&&(y.height=t.current.element.offsetHeight,y.width=t.current.element.offsetWidth),Object.freeze(y),u.current&&!We(t.current.lastBounds,y)&&b(t.current.lastBounds=y)};return[i,j?Q(i,j):i,a?Q(i,a):i]},[b,h,a,j]);function S(){t.current.scrollContainers&&(t.current.scrollContainers.forEach(i=>i.removeEventListener("scroll",l,!0)),t.current.scrollContainers=null),t.current.resizeObserver&&(t.current.resizeObserver.disconnect(),t.current.resizeObserver=null),t.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",t.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",t.current.orientationHandler))}function p(){t.current.element&&(t.current.resizeObserver=new g(l),t.current.resizeObserver.observe(t.current.element),n&&t.current.scrollContainers&&t.current.scrollContainers.forEach(i=>i.addEventListener("scroll",l,{capture:!0,passive:!0})),t.current.orientationHandler=()=>{l()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",t.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",t.current.orientationHandler))}const M=i=>{!i||i===t.current.element||(S(),t.current.element=i,t.current.scrollContainers=ne(i),p())};return Ue(l,!!n),Fe(m),o.useEffect(()=>{S(),p()},[n,l,m]),o.useEffect(()=>S,[]),[M,c,w]}function Fe(e){o.useEffect(()=>{const n=e;return window.addEventListener("resize",n),()=>void window.removeEventListener("resize",n)},[e])}function Ue(e,n){o.useEffect(()=>{if(n){const d=e;return window.addEventListener("scroll",d,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",d,!0)}},[e,n])}function ne(e){const n=[];if(!e||e===document.body)return n;const{overflow:d,overflowX:h,overflowY:g}=window.getComputedStyle(e);return[d,h,g].some(c=>c==="auto"||c==="scroll")&&n.push(e),[...n,...ne(e.parentElement)]}const Ne=["x","y","top","bottom","left","right","width","height"],We=(e,n)=>Ne.every(d=>e[d]===n[d]);function qe({ref:e,children:n,fallback:d,resize:h,style:g,gl:c,events:b=we,eventSource:t,eventPrefix:a,shadows:j,linear:u,flat:w,legacy:m,orthographic:l,frameloop:S,dpr:p,performance:M,raycaster:i,camera:_,scene:s,onPointerMissed:f,onCreated:R,...L}){o.useMemo(()=>he(pe),[]);const x=fe(),[C,E]=Oe({scroll:!0,debounce:{scroll:50,resize:0},...h}),y=o.useRef(null),v=o.useRef(null);o.useImperativeHandle(e,()=>y.current);const N=me(f),[W,se]=o.useState(!1),[q,ae]=o.useState(!1);if(W)throw W;if(q)throw q;const T=o.useRef(null);ge(()=>{const P=y.current;if(E.width>0&&E.height>0&&P){T.current||(T.current=be(P));async function ce(){await T.current.configure({gl:c,scene:s,events:b,shadows:j,linear:u,flat:w,legacy:m,orthographic:l,frameloop:S,dpr:p,performance:M,raycaster:i,camera:_,size:E,onPointerMissed:(...I)=>N.current==null?void 0:N.current(...I),onCreated:I=>{I.events.connect==null||I.events.connect(t?xe(t)?t.current:t:v.current),a&&I.setEvents({compute:(X,B)=>{const le=X[a+"X"],ue=X[a+"Y"];B.pointer.set(le/B.size.width*2-1,-(ue/B.size.height)*2+1),B.raycaster.setFromCamera(B.pointer,B.camera)}}),R?.(I)}}),T.current.render(r.jsx(x,{children:r.jsx(ye,{set:ae,children:r.jsx(o.Suspense,{fallback:r.jsx(ve,{set:se}),children:n??null})})}))}ce()}}),o.useEffect(()=>{const P=y.current;if(P)return()=>je(P)},[]);const ie=t?"none":"auto";return r.jsx("div",{ref:v,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ie,...g},...L,children:r.jsx("div",{ref:C,style:{width:"100%",height:"100%"},children:r.jsx("canvas",{ref:y,style:{display:"block"},children:d})})})}function Ve(e){return r.jsx(de,{children:r.jsx(qe,{...e})})}const Xe=()=>{const e=new Se,n=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1]);e.setAttribute("position",new Y(n,3));const d=new Uint16Array([0,1,2,2,3,0,1,5,6,6,2,1,4,0,3,3,7,4,4,5,1,1,0,4,3,2,6,6,7,3,5,4,7,7,6,5]);e.setIndex(new Y(d,1));const h=[new O({color:16711680}),new O({color:65280}),new O({color:255})];e.addGroup(0,6,0),e.addGroup(6,6,1),e.addGroup(12,6,2),e.addGroup(18,6,0),e.addGroup(24,6,1),e.addGroup(30,6,2);const g=new Ce(e,h);g.name="IndexedCube3Materials";const c=new Me;c.__inspectorData.isInspectable=!0,c.name="IndexedCube3Materials group",c.add(g);const b=new Re(16777215,1);return b.name="IndexedCube3Materials pointLight",g.add(b),c};class Ye{static fromCubeTexture(n){let d=0;const h=new D,g=new D,c=new A,b=[0,0,0,0,0,0,0,0,0],t=new H,a=t.coefficients;for(let u=0;u<6;u++){const w=n.image[u],m=w.width,l=w.height,S=document.createElement("canvas");S.width=m,S.height=l;const p=S.getContext("2d");p.drawImage(w,0,0,m,l);const M=p.getImageData(0,0,m,l),i=M.data,_=M.width,s=2/_;for(let f=0,R=i.length;f<R;f+=4){c.setRGB(i[f]/255,i[f+1]/255,i[f+2]/255),K(c,n.colorSpace);const L=f/4,x=-1+(L%_+.5)*s,C=1-(Math.floor(L/_)+.5)*s;switch(u){case 0:h.set(-1,C,-x);break;case 1:h.set(1,C,x);break;case 2:h.set(-x,1,-C);break;case 3:h.set(-x,-1,C);break;case 4:h.set(-x,C,1);break;case 5:h.set(x,C,-1);break}const E=h.lengthSq(),y=4/(Math.sqrt(E)*E);d+=y,g.copy(h).normalize(),H.getBasisAt(g,b);for(let v=0;v<9;v++)a[v].x+=b[v]*c.r*y,a[v].y+=b[v]*c.g*y,a[v].z+=b[v]*c.b*y}}const j=4*Math.PI/d;for(let u=0;u<9;u++)a[u].x*=j,a[u].y*=j,a[u].z*=j;return new J(t)}static async fromCubeRenderTarget(n,d){const h=n.coordinateSystem===Le?-1:1;let g=0;const c=new D,b=new D,t=new A,a=[0,0,0,0,0,0,0,0,0],j=new H,u=j.coefficients,w=d.texture.type,m=d.width;let l;n.isWebGLRenderer&&(w===V?l=new Uint16Array(m*m*4):l=new Uint8Array(m*m*4));for(let p=0;p<6;p++){n.isWebGLRenderer?await n.readRenderTargetPixelsAsync(d,0,0,m,m,l,p):l=await n.readRenderTargetPixelsAsync(d,0,0,m,m,0,p);const M=2/m;for(let i=0,_=l.length;i<_;i+=4){let s,f,R;w===V?(s=F.fromHalfFloat(l[i]),f=F.fromHalfFloat(l[i+1]),R=F.fromHalfFloat(l[i+2])):(s=l[i]/255,f=l[i+1]/255,R=l[i+2]/255),t.setRGB(s,f,R),K(t,d.texture.colorSpace);const L=i/4,x=(1-(L%m+.5)*M)*h,C=1-(Math.floor(L/m)+.5)*M;switch(p){case 0:c.set(-1*h,C,x*h);break;case 1:c.set(1*h,C,-x*h);break;case 2:c.set(x,1,-C);break;case 3:c.set(x,-1,C);break;case 4:c.set(x,C,1);break;case 5:c.set(-x,C,-1);break}const E=c.lengthSq(),y=4/(Math.sqrt(E)*E);g+=y,b.copy(c).normalize(),H.getBasisAt(b,a);for(let v=0;v<9;v++)u[v].x+=a[v]*t.r*y,u[v].y+=a[v]*t.g*y,u[v].z+=a[v]*t.b*y}}const S=4*Math.PI/g;for(let p=0;p<9;p++)u[p].x*=S,u[p].y*=S,u[p].z*=S;return new J(j)}}function K(e,n){switch(n){case re:e.convertSRGBToLinear();break;case Ee:case _e:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return e}const z=Ae.degToRad,oe=new ke;document.body.appendChild(oe.dom);const ee=Ie();function te(e){const n=o.useRef(null),[d,h]=o.useState(!1),[g,c]=o.useState(!1),[b,t]=o.useState(null),[a,j]=o.useState(null),u=o.useRef(null),{position:w=[0,0,0],mapURL:m,alphaMapURL:l,...S}=e;return U((p,M,i)=>{p==="playing"?n.current&&(n.current.rotation.x+=i):p==="stopped"&&n.current&&(n.current.rotation.x=0)}),o.useEffect(()=>k.registerDefaultPlayTriggers(),[]),o.useEffect(()=>{k.createTexturesFromImages(m,{material:u}).then(p=>{const M=p[0];t(M)}),l&&k.createTexturesFromImages(l,{material:u}).then(p=>{const M=p[0];j(M)})},[m,l]),r.jsxs("mesh",{...S,ref:n,scale:g?1.05:1,position:w,children:[r.jsx("boxGeometry",{args:[1,1,1]}),r.jsx("meshStandardMaterial",{ref:u,color:d?"hotpink":"white",map:b,alphaMap:a,roughness:0,metalness:1}),e.children]})}function Ze(){const{scene:e,gl:n,clock:d,camera:h}=Be(),g=o.useRef(null),c=o.useRef(null),b=o.useRef(null),t=o.useRef(null),a=o.useRef(null),j=o.useRef(null),u=o.useRef(new ze(1024,{})),w=o.useRef({myImage:null,myBool:!1,myNumber:.23,myPoint:{x:.5,y:.5}}),[m,l]=o.useState(!1),[S,p]=o.useState({x:.5,y:.5}),[M,i]=o.useState(1.23),_=o.useRef(new Pe);return Ge((s,f)=>{oe.update()}),U((s,f,R)=>{c.current,j.current&&j.current.rotateX(.01),g.current&&g.current.translateX(.01),c.current&&c.current.translateZ(.01),b.current&&b.current.translateZ(.01),w.current&&(w.current.myNumber+=.01)},0,[m]),U((s,f,R)=>{}),o.useEffect(()=>{k.createTexturesFromImages(["alpha.jpg","ao.jpg","color.jpg","height.jpg","metalness.jpg","normal.jpg","roughness.jpg"].map(s=>`textures/pbr/door/${s}`)).then(s=>{a.current&&(a.current.alphaMap=s[0],a.current.aoMap=s[1],s[2].colorSpace=re,a.current.map=s[2],a.current.bumpMap=s[3],a.current.metalnessMap=s[4],a.current.normalMap=s[5],a.current.roughnessMap=s[6],a.current.metalness=1,a.current.roughness=.7,a.current.transparent=!0,a.current.needsUpdate=!0)})},[]),o.useEffect(()=>{k.createTexturesFromImages("textures/background/equirectangular/spruit_sunrise_4k.hdr.jpg",{}).then(s=>{const f=s[0];f.mapping=f instanceof Z?Te:f.image.width/f.image.height===2?De:He,f.needsUpdate=!0,t.current&&f instanceof Z&&(t.current.copy(Ye.fromCubeTexture(f)),t.current.name="myLightProbe",t.current.intensity=1),e.background=f,e.environment=f,a.current,k.refreshCPanel(),k.updateCubeCameras(),k.loadObject(["Jennifer.glb","Animations_gltf/Idle.glb","Animations_gltf/Catwalk_Walk_Forward.glb"],{scene:e,camera:h,autoScaleRatio:.4,path:"models/Free/gltf/Mixamo/Jennifer/"}).then(x=>{x&&(x.__inspectorData.isInspectable=!0,e.add(x),setTimeout(()=>{},8e3))});const R=Xe(),L=k.splitMeshesByMaterial(R,{});L.castShadow=!0,L.receiveShadow=!0,L.__inspectorData.isInspectable=!0,e.add(L),ee.uniforms.tDiffuse.value=g.current.shadow.map?.texture})},[]),r.jsxs(r.Fragment,{children:[r.jsxs("group",{name:"lights group",children:[r.jsx("directionalLight",{"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-radius":4,"shadow-camera-right":15,"shadow-camera-left":-15,"shadow-camera-top":15,"shadow-camera-bottom":-15,"shadow-blurSamples":8,castShadow:!0,position:[2,2,2],scale:1,intensity:4.5,ref:g,color:"white",__inspectorData:{isInspectable:!1}}),r.jsx("hemisphereLight",{intensity:2,color:new A().setHSL(.6,1,.6),groundColor:new A().setHSL(.095,1,.75)}),r.jsx("ambientLight",{color:"#ffffff",intensity:3.5,position:[0,1,0]}),r.jsx("rectAreaLight",{color:"deepskyblue",position:[-3,0,-8],rotation:[-2.51,0,0],intensity:6,width:10,height:10}),r.jsx("pointLight",{castShadow:!0,position:[0,-2,0],color:"orange",scale:1,intensity:Math.PI,ref:c,__inspectorData:{isInspectable:!1}}),r.jsx("spotLight",{castShadow:!0,position:[5.5,-.7,.3],scale:1,intensity:66,distance:30,color:"deepskyblue",angle:Math.PI/8,penumbra:.5,decay:.1,ref:b}),r.jsx("lightProbe",{ref:t,color:"blue",position:[0,0,3],name:"myLightProbe"})]}),r.jsx(te,{castShadow:!0,receiveShadow:!0,mapURL:"textures/utils/checkerboard-8x8.png",position:[-1.2,S.x,S.y],__inspectorData:{isInspectable:!0},name:"Box 1"}),r.jsx(te,{mapURL:"textures/utils/checkerboard-8x8.png",alphaMapURL:"textures/utils/checkerboard-8x8.png",position:[1.2,0,0],__inspectorData:{isInspectable:!0},castShadow:!0,receiveShadow:!0,name:"Box 2",children:r.jsxs("mesh",{position:[1.5,.5,0],__inspectorData:{isInspectable:!0},name:"Box 2 child",children:[r.jsx("boxGeometry",{args:[1,1,1]}),r.jsx("meshStandardMaterial",{})]})}),r.jsxs("mesh",{name:"plane",rotation:[-1.5,0,0],position:[-5,-7.23,-3],receiveShadow:!0,__inspectorData:{isInspectable:!0},children:[r.jsx("planeGeometry",{args:[32,32]}),r.jsx("meshStandardMaterial",{color:"white",side:$})]}),r.jsx("mesh",{name:"shMapPlane",rotation:[-1.5,0,0],position:[-15,-17.23,-3],receiveShadow:!1,castShadow:!1,__inspectorData:{isInspectable:!0},material:ee,children:r.jsx("planeGeometry",{args:[32,32]})}),r.jsxs("mesh",{name:"door",rotation:[0,0,0],position:[0,0,-2],receiveShadow:!0,castShadow:!0,__inspectorData:{isInspectable:!0},children:[r.jsx("planeGeometry",{args:[16,16]}),r.jsx("meshPhysicalMaterial",{ref:a,side:$})]}),r.jsx("positionalAudio",{args:[_.current],position:[0,0,5]}),r.jsx("perspectiveCamera",{args:[75,1,.1,100],position:[-12.98,3.963,4.346],name:"myPerspectiveCamera",rotation:[z(-42.342),z(-65.604),z(-39.706)],__inspectorData:{useOnPlay:!0}}),r.jsx("orthographicCamera",{args:[1,-1,1,-1,.1,1e4],zoom:45,position:[-10.98,1.963,1.346],name:"myOrthographicCamera",rotation:[z(-42.342),z(-65.604),z(-39.706)],__inspectorData:{useOnPlay:!1}}),r.jsx("cubeCamera",{ref:j,name:"myCubeCamera",args:[.1,1e3,u.current],position:[0,0,8]}),r.jsx(G,{name:"myBool",object:w.current,prop:"myBool",control:{label:"My Bool",onChange:s=>{l(s)}}}),r.jsx(G,{name:"myBool_2",object:w.current,prop:"myBool",control:{label:"My Bool",onChange:s=>{l(s)}}}),m&&r.jsxs(r.Fragment,{children:[r.jsx(G,{name:"SceneBG",object:e,prop:"background",control:{label:"Texture",gl:n,color:{type:"float"},onChange:(...s)=>{console.log("Experience reacting to SceneBG value change",s)}}}),r.jsx(G,{name:"myNumber",object:w.current,prop:"myNumber",control:{label:"My Number",step:.01,keyScale:.1,pointerScale:.01,onChange:s=>{w.current.myPoint.x=s}}}),r.jsx(G,{name:"myPoint",object:w.current,prop:"myPoint",control:{label:"Point",step:.01,keyScale:.1,pointerScale:.01,onChange:s=>{p({...s}),w.current.myNumber=s.x}}})]})]})}export{Ve as C,Ze as E};
//# sourceMappingURL=Experience-BSqkvR_s.js.map
