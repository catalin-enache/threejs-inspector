import{I as V,J as F,M as A,N as Y,Q as Z,R as $,V as D,n as v,U as T,X as z,Y as Q,Z as N,$ as U,a0 as K,a1 as ee,a2 as J,r as o,a as te,l as ae,h as R,a3 as re,a4 as se,a5 as oe,a6 as ne,a7 as ie,a8 as W,a9 as ce,j as e,aa as q,ab as le}from"./projects-C5UWmgOH.js";import{u as E,C as G}from"./CustomControl-DBtwyu-d.js";import{u as ue}from"./useStats-B1IObBFO.js";const pe=()=>{const m=new V,i=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1]);m.setAttribute("position",new F(i,3));const l=new Uint16Array([0,1,2,2,3,0,1,5,6,6,2,1,4,0,3,3,7,4,4,5,1,1,0,4,3,2,6,6,7,3,5,4,7,7,6,5]);m.setIndex(new F(l,1));const u=[new A({color:16711680}),new A({color:65280}),new A({color:255})];m.addGroup(0,6,0),m.addGroup(6,6,1),m.addGroup(12,6,2),m.addGroup(18,6,0),m.addGroup(24,6,1),m.addGroup(30,6,2);const j=new Y(m,u);j.name="IndexedCube3Materials";const s=new Z;s.__inspectorData.isInspectable=!0,s.name="IndexedCube3Materials group",s.add(j);const d=new $(16777215,1);return d.name="IndexedCube3Materials pointLight",j.add(d),s};class he{static fromCubeTexture(i){let l=0;const u=new D,j=new D,s=new v,d=[0,0,0,0,0,0,0,0,0],w=new T,f=w.coefficients;for(let t=0;t<6;t++){const M=i.image[t],c=M.width,r=M.height,C=document.createElement("canvas");C.width=c,C.height=r;const n=C.getContext("2d");n.drawImage(M,0,0,c,r);const S=n.getImageData(0,0,c,r),p=S.data,P=S.width,k=2/P;for(let _=0,a=p.length;_<a;_+=4){s.setRGB(p[_]/255,p[_+1]/255,p[_+2]/255),H(s,i.colorSpace);const g=_/4,b=-1+(g%P+.5)*k,h=1-(Math.floor(g/P)+.5)*k;switch(t){case 0:u.set(-1,h,-b);break;case 1:u.set(1,h,b);break;case 2:u.set(-b,1,-h);break;case 3:u.set(-b,-1,h);break;case 4:u.set(-b,h,1);break;case 5:u.set(b,h,-1);break}const L=u.lengthSq(),I=4/(Math.sqrt(L)*L);l+=I,j.copy(u).normalize(),T.getBasisAt(j,d);for(let x=0;x<9;x++)f[x].x+=d[x]*s.r*I,f[x].y+=d[x]*s.g*I,f[x].z+=d[x]*s.b*I}}const y=4*Math.PI/l;for(let t=0;t<9;t++)f[t].x*=y,f[t].y*=y,f[t].z*=y;return new z(w)}static async fromCubeRenderTarget(i,l){const u=i.coordinateSystem===Q?-1:1;let j=0;const s=new D,d=new D,w=new v,f=[0,0,0,0,0,0,0,0,0],y=new T,t=y.coefficients,M=l.texture.type,c=l.width;let r;i.isWebGLRenderer&&(M===N?r=new Uint16Array(c*c*4):r=new Uint8Array(c*c*4));for(let n=0;n<6;n++){i.isWebGLRenderer?await i.readRenderTargetPixelsAsync(l,0,0,c,c,r,n):r=await i.readRenderTargetPixelsAsync(l,0,0,c,c,0,n);const S=2/c;for(let p=0,P=r.length;p<P;p+=4){let k,_,a;M===N?(k=U.fromHalfFloat(r[p]),_=U.fromHalfFloat(r[p+1]),a=U.fromHalfFloat(r[p+2])):(k=r[p]/255,_=r[p+1]/255,a=r[p+2]/255),w.setRGB(k,_,a),H(w,l.texture.colorSpace);const g=p/4,b=(1-(g%c+.5)*S)*u,h=1-(Math.floor(g/c)+.5)*S;switch(n){case 0:s.set(-1*u,h,b*u);break;case 1:s.set(1*u,h,-b*u);break;case 2:s.set(b,1,-h);break;case 3:s.set(b,-1,h);break;case 4:s.set(b,h,1);break;case 5:s.set(-b,h,-1);break}const L=s.lengthSq(),I=4/(Math.sqrt(L)*L);j+=I,d.copy(s).normalize(),T.getBasisAt(d,f);for(let x=0;x<9;x++)t[x].x+=f[x]*w.r*I,t[x].y+=f[x]*w.g*I,t[x].z+=f[x]*w.b*I}}const C=4*Math.PI/j;for(let n=0;n<9;n++)t[n].x*=C,t[n].y*=C,t[n].z*=C;return new z(y)}}function H(m,i){switch(i){case J:m.convertSRGBToLinear();break;case ee:case K:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return m}const B=le.degToRad,O=ce();function X(m){const i=o.useRef(null),[l,u]=o.useState(!1),[j,s]=o.useState(!1),[d,w]=o.useState(null),[f,y]=o.useState(null),t=o.useRef(null),{position:M=[0,0,0],mapURL:c,alphaMapURL:r,...C}=m;return E((n,S,p)=>{n==="playing"?i.current&&(i.current.rotation.x+=p):n==="stopped"&&i.current&&(i.current.rotation.x=0)}),o.useEffect(()=>{R.createTexturesFromImages(c,{material:t}).then(n=>{const S=n[0];w(S)}),r&&R.createTexturesFromImages(r,{material:t}).then(n=>{const S=n[0];y(S)})},[c,r]),e.jsxs("mesh",{...C,ref:i,scale:j?1.05:1,position:M,children:[e.jsx("boxGeometry",{args:[1,1,1]}),e.jsx("meshStandardMaterial",{ref:t,color:l?"hotpink":"white",map:d,alphaMap:f,roughness:0,metalness:1}),m.children]})}const ge=o.memo(function(){const i=o.useRef(!1),{scene:l,gl:u,clock:j,camera:s}=te();ue(),o.useEffect(()=>{s.position.set(0,0,22),s.rotation.set(0,0,0),s instanceof ae&&(s.zoom=25)},[s]),o.useEffect(()=>(R.updateSceneBBox(),R.registerDefaultPlayTriggers()),[]);const d=o.useRef(null),w=o.useRef(null),f=o.useRef(null),y=o.useRef(null),t=o.useRef(null),M=o.useRef(null),c=o.useRef(new re(1024,{})),r=o.useRef({myImage:null,myBool:!1,myNumber:.23,myPoint:{x:.5,y:.5}}),[C,n]=o.useState(!1),[S,p]=o.useState({x:.5,y:.5}),[P,k]=o.useState(1.23),_=o.useRef(new se);return E((a,g,b)=>{w.current,M.current&&M.current.rotateX(.01),d.current&&d.current.translateX(.01),w.current&&w.current.translateZ(.01),f.current&&f.current.translateZ(.01),r.current&&(r.current.myNumber+=.01)},0,[C]),E((a,g,b)=>{}),o.useEffect(()=>{i.current||R.createTexturesFromImages(["alpha.jpg","ao.jpg","color.jpg","height.jpg","metalness.jpg","normal.jpg","roughness.jpg"].map(a=>`textures/pbr/door/${a}`)).then(a=>{t.current&&(t.current.alphaMap=a[0],t.current.aoMap=a[1],a[2].colorSpace=J,t.current.map=a[2],t.current.bumpMap=a[3],t.current.metalnessMap=a[4],t.current.normalMap=a[5],t.current.roughnessMap=a[6],t.current.metalness=1,t.current.roughness=.7,t.current.transparent=!0,t.current.needsUpdate=!0)})},[]),o.useEffect(()=>{i.current||R.createTexturesFromImages("textures/background/equirectangular/spruit_sunrise_4k.hdr.jpg",{}).then(a=>{const g=a[0];g.mapping=g instanceof W?oe:g.image.width/g.image.height===2?ne:ie,g.needsUpdate=!0,y.current&&g instanceof W&&(y.current.copy(he.fromCubeTexture(g)),y.current.name="myLightProbe",y.current.intensity=1),l.background=g,l.environment=g,t.current,R.refreshCPanel(),R.updateCubeCameras(),R.loadObject(["Jennifer.glb","Animations_gltf/Idle.glb","Animations_gltf/Catwalk_Walk_Forward.glb"],{scene:l,camera:s,autoScaleRatio:.4,path:"models/Free/gltf/Mixamo/Jennifer/"}).then(L=>{L&&(L.__inspectorData.isInspectable=!0,l.add(L),setTimeout(()=>{},8e3))});const b=pe(),h=R.splitMeshesByMaterial(b,{});h.castShadow=!0,h.receiveShadow=!0,h.__inspectorData.isInspectable=!0,l.add(h),O.uniforms.tDiffuse.value=d.current.shadow.map?.texture})},[]),o.useEffect(()=>{i.current=!0},[]),e.jsxs(e.Fragment,{children:[e.jsxs("group",{name:"lights group",children:[e.jsx("directionalLight",{"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-radius":4,"shadow-camera-right":15,"shadow-camera-left":-15,"shadow-camera-top":15,"shadow-camera-bottom":-15,"shadow-blurSamples":8,castShadow:!0,position:[2,2,2],scale:1,intensity:4.5,ref:d,color:"white",__inspectorData:{isInspectable:!1}}),e.jsx("hemisphereLight",{intensity:2,color:new v().setHSL(.6,1,.6),groundColor:new v().setHSL(.095,1,.75)}),e.jsx("ambientLight",{color:"#ffffff",intensity:3.5,position:[0,1,0]}),e.jsx("rectAreaLight",{color:"deepskyblue",position:[-3,0,-8],rotation:[-2.51,0,0],intensity:6,width:10,height:10}),e.jsx("pointLight",{castShadow:!0,position:[0,-2,0],color:"orange",scale:1,intensity:Math.PI,ref:w,__inspectorData:{isInspectable:!1}}),e.jsx("spotLight",{castShadow:!0,position:[5.5,-.7,.3],scale:1,intensity:66,distance:30,color:"deepskyblue",angle:Math.PI/8,penumbra:.5,decay:.1,ref:f}),e.jsx("lightProbe",{ref:y,color:"blue",position:[0,0,3],name:"myLightProbe"})]}),e.jsx(X,{castShadow:!0,receiveShadow:!0,mapURL:"textures/utils/checkerboard-8x8.png",position:[-1.2,S.x,S.y],__inspectorData:{isInspectable:!0},name:"Box 1"}),e.jsx(X,{mapURL:"textures/utils/checkerboard-8x8.png",alphaMapURL:"textures/utils/checkerboard-8x8.png",position:[1.2,0,0],__inspectorData:{isInspectable:!0},castShadow:!0,receiveShadow:!0,name:"Box 2",children:e.jsxs("mesh",{position:[1.5,.5,0],__inspectorData:{isInspectable:!0},name:"Box 2 child",children:[e.jsx("boxGeometry",{args:[1,1,1]}),e.jsx("meshStandardMaterial",{})]})}),e.jsxs("mesh",{name:"plane",rotation:[-1.5,0,0],position:[-5,-7.23,-3],receiveShadow:!0,__inspectorData:{isInspectable:!0},children:[e.jsx("planeGeometry",{args:[32,32]}),e.jsx("meshStandardMaterial",{color:"white",side:q})]}),e.jsx("mesh",{name:"shMapPlane",rotation:[-1.5,0,0],position:[-15,-17.23,-3],receiveShadow:!1,castShadow:!1,__inspectorData:{isInspectable:!0},material:O,children:e.jsx("planeGeometry",{args:[32,32]})}),e.jsxs("mesh",{name:"door",rotation:[0,0,0],position:[0,0,-2],receiveShadow:!0,castShadow:!0,__inspectorData:{isInspectable:!0},children:[e.jsx("planeGeometry",{args:[16,16]}),e.jsx("meshPhysicalMaterial",{ref:t,side:q})]}),e.jsx("positionalAudio",{args:[_.current],position:[0,0,5]}),e.jsx("perspectiveCamera",{args:[75,1,.1,100],position:[-12.98,3.963,4.346],name:"myPerspectiveCamera",rotation:[B(-42.342),B(-65.604),B(-39.706)],__inspectorData:{useOnPlay:!0}}),e.jsx("orthographicCamera",{args:[1,-1,1,-1,.1,1e4],zoom:45,position:[-10.98,1.963,1.346],name:"myOrthographicCamera",rotation:[B(-42.342),B(-65.604),B(-39.706)],__inspectorData:{useOnPlay:!1}}),e.jsx("cubeCamera",{ref:M,name:"myCubeCamera",args:[.1,1e3,c.current],position:[0,0,8]}),e.jsx(G,{name:"myBool",object:r.current,prop:"myBool",control:{label:"My Bool",onChange:a=>{n(a)}}}),e.jsx(G,{name:"myBool_2",object:r.current,prop:"myBool",control:{label:"My Bool",onChange:a=>{n(a)}}}),C&&e.jsxs(e.Fragment,{children:[e.jsx(G,{name:"SceneBG",object:l,prop:"background",control:{label:"Texture",gl:u,color:{type:"float"},onChange:(...a)=>{console.log("Experience reacting to SceneBG value change",a)}}}),e.jsx(G,{name:"myNumber",object:r.current,prop:"myNumber",control:{label:"My Number",step:.01,keyScale:.1,pointerScale:.01,onChange:a=>{r.current.myPoint.x=a}}}),e.jsx(G,{name:"myPoint",object:r.current,prop:"myPoint",control:{label:"Point",step:.01,keyScale:.1,pointerScale:.01,onChange:a=>{p({...a}),r.current.myNumber=a.x}}})]})]})});export{ge as Experience,ge as default};
//# sourceMappingURL=Experience-CfWd78LV.js.map
